// batch@0.6.1 downloaded from https://ga.jspm.io/npm:batch@0.6.1/index.js

import t from"events";import n from"emitter";import e from"process";var r="undefined"!==typeof globalThis?globalThis:"undefined"!==typeof self?self:global;var o={};var i=e;try{var a=t.EventEmitter;if(!a)throw new Error}catch(t){var c=n}var f="undefined"!==typeof i&&i&&"function"===typeof i.nextTick?i.nextTick:function(t){setTimeout(t)};function noop(){}o=Batch;function Batch(){if(!((this||r)instanceof Batch))return new Batch;(this||r).fns=[];this.concurrency(Infinity);this.throws(true);for(var t=0,n=arguments.length;t<n;++t)this.push(arguments[t])}a?Batch.prototype.__proto__=a.prototype:c(Batch.prototype);Batch.prototype.concurrency=function(t){(this||r).n=t;return this||r};Batch.prototype.push=function(t){(this||r).fns.push(t);return this||r};Batch.prototype.throws=function(t){(this||r).e=!!t;return this||r};Batch.prototype.end=function(t){var n=this||r,e=(this||r).fns.length,o=e,i=[],a=[],t=t||noop,c=(this||r).fns,h=(this||r).n,s=(this||r).e,u=0,p;if(!c.length)return f((function(){t(null,i)}));function next(){var r=u++;var h=c[r];if(h){var l=new Date;try{h(callback)}catch(t){callback(t)}}function callback(c,h){if(!p){if(c&&s)return p=true,f((function(){t(c)}));var u=e-o+1;var v=new Date;i[r]=h;a[r]=c;n.emit("progress",{index:r,value:h,error:c,pending:o,total:e,complete:u,percent:u/e*100|0,start:l,end:v,duration:v-l});--o?next():f((function(){t(s?null:a,i)}))}}}for(var l=0;l<c.length;l++){if(l==h)break;next()}return this||r};var h=o;export default h;

