// on-finished@2.3.0 downloaded from https://ga.jspm.io/npm:on-finished@2.3.0/index.js

import e from"ee-first";import n from"process";var i={};var t=n;i=onFinished;i.isFinished=isFinished;var o=e;var s="function"===typeof t.nextTick?t.nextTick:function(e){t.nextTick(e.bind.apply(e,arguments))};function onFinished(e,n){if(false!==isFinished(e)){s(n,null,e);return e}attachListener(e,n);return e}function isFinished(e){var n=e.socket;return"boolean"===typeof e.finished?Boolean(e.finished||n&&!n.writable):"boolean"===typeof e.complete?Boolean(e.upgrade||!n||!n.readable||e.complete&&!e.readable):void 0}function attachFinishedListener(e,n){var i;var t;var s=false;function onFinish(e){i.cancel();t.cancel();s=true;n(e)}i=t=o([[e,"end","finish"]],onFinish);function onSocket(n){e.removeListener("socket",onSocket);s||i===t&&(t=o([[n,"error","close"]],onFinish))}if(e.socket)onSocket(e.socket);else{e.on("socket",onSocket);void 0===e.socket&&patchAssignSocket(e,onSocket)}}function attachListener(e,n){var i=e.__onFinished;if(!i||!i.queue){i=e.__onFinished=createListener(e);attachFinishedListener(e,i)}i.queue.push(n)}function createListener(e){function listener(n){e.__onFinished===listener&&(e.__onFinished=null);if(listener.queue){var i=listener.queue;listener.queue=null;for(var t=0;t<i.length;t++)i[t](n,e)}}listener.queue=[];return listener}function patchAssignSocket(e,n){var i=e.assignSocket;"function"===typeof i&&(e.assignSocket=function _assignSocket(e){i.call(this,e);n(e)})}var r=i;const c=i.isFinished;export default r;export{c as isFinished};

